split_long_rows(0)

d = [
#1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27
-1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; #  1
 1,-1, 0, 0, 0,-1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; #  2
 0, 1,-1, 0, 0, 0, 0,-1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; #  3
 0, 0, 1,-1, 0, 0, 0, 0, 0,-1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; #  4
 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,-1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; #  5
 0, 0, 0, 0,-1, 1, 0, 0, 0, 0, 0, 0,-1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; #  6
 0, 0, 0, 0, 0, 0,-1, 1, 0, 0, 0, 0, 1, 0, 0,-1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; #  7
 0, 0, 0, 0, 0, 0, 0, 0,-1, 1, 0, 0, 0,-1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; #  8
 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,-1, 1, 0, 1, 0, 0, 0,-1, 0, 0, 0, 0, 0, 0, 0, 0, 0; #  9
 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,-1, 1, 0, 0,-1, 0, 1, 0, 0, 0, 0, 0, 0; # 10
 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,-1, 0,-1, 1, 0, 0, 0, 0; # 11
 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,-1, 1, 0, 1, 0, 0, 0,-1, 0, 0, 0; # 12
 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,-1, 1, 0, 0,-1, 1, 0; # 13
 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,-1, 1, 1, 0,-1; # 14
 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,-1, 1  # 15
]

rref(d)

B = [
#1 2 3 4 5 6 7 8 9101112131415161718192021222324252627
 1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
 0,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
 0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
 0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
 0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0;
 0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,0,0,0,0,0,0,0,0;
 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,0,0,0,0;
 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,0,0;
 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1
]';

d*B

Z = [
#1  2  3  4  5  6  7  8  9 10 11 12 13
 1, 0, 0, 0,-1, 0, 1, 0,-1, 0, 1, 0, 0; #  1
 0, 1, 0, 0, 0, 0, 0, 0,-1, 0, 1, 0, 0; #  2
 0, 0, 1, 0, 0,-1, 0, 1, 0, 0, 0, 0, 0; #  3
 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0; #  4
 1, 0, 0, 0,-1, 0, 1, 0,-1, 0, 1, 0, 0; #  5
 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; #  6
 0, 1, 0, 0, 1, 0,-1, 0, 0, 0, 0, 0, 0; #  7
 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; #  8
 0, 0, 1, 0, 0,-1, 0, 1, 1, 0,-1, 0, 0; #  9
 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; # 10
 0, 0, 0, 1, 0, 1, 0,-1, 0, 0, 0, 0, 0; # 11
 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0; # 12
 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0; # 13
 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0; # 14
 0, 0, 0, 0, 0, 0, 1, 0,-1, 0, 1, 0, 0; # 15
 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0; # 16
 0, 0, 0, 0, 0, 0, 0, 1, 1, 0,-1, 0, 0; # 17
 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0; # 18
 0, 0, 0, 0, 0, 0, 0, 0, 1, 1,-1,-1, 1; # 19
 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0; # 20
 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,-1, 1; # 21
 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0; # 22
 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1,-1; # 23
 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0; # 24
 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0; # 25
 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; # 26
 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1  # 27
]

d * Z

T = zeros(22, 9);
T(1:9,1:27) = B';
T(10:22,1:27) = Z';

T

for i = (2:22)
	T(i,:) = T(i,:) - T(i,1) * T(1,:);
end
for i = (3:22)
	T(i,:) = T(i,:) - T(i,2) * T(2,:);
end
for i = (4:22)
	T(i,:) = T(i,:) - T(i,3) * T(3,:);
end
for i = (5:22)
	T(i,:) = T(i,:) - T(i,4) * T(4,:);
end

T

for i = (15:22)
	T(i,:) = T(i,:) - T(i,6) * T(14,:);
end
T
for i = (19:22)
	T(i,:) = T(i,:) - T(i,8) * T(18,:);
end
T
for i = (16:22)
	T(i,:) = T(i,:) - T(i,10) * T(15,:);
end
T
for i = (6:22)
	T(i,:) = T(i,:) - T(i,13) * T(5,:);
end
T
for i = (7:22)
	T(i,:) = T(i,:) - T(i,14) * T(6,:);
end
T
for i = (8:22)
	T(i,:) = T(i,:) - T(i,19) * T(7,:);
end
T
for i = (9:22)
	T(i,:) = T(i,:) - T(i,20) * T(8,:);
end
T
for i = (22:22)
	T(i,:) = T(i,:) - T(i,22) * T(21,:);
end
T
for i = (10:22)
	T(i,:) = T(i,:) - T(i,25) * T(9,:);
end
#
T
